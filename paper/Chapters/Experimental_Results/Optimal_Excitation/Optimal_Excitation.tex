% !TEX encoding = UTF-8 Unicode
% !TEX spellcheck = en_US
% !TEX root = ../../../ICMA2020.tex

\subsection{Optimal Excitation}
\label{subsec:OptimalExcitation_Result}


In consideration of the optimized trajectories from Sec.\,\ref{subsec:ExperimentScenario} the robot parameters are estimated using the WLS method according to \eqref{eq:ParameterEstimation_WLS}. The filtering of the respective measurement data in the frequency domain yields nearly noise free estimates of the joint angular positions, velocities and accelerations. According to \cite{Khalil.2006} it is possible to estimate the relative standard deviation $\sigma_{i}^*$ of the identified parameters for the LS method under the assumption of a deterministic design matrix and the error $\boldsymbol{e}$ as zero-mean additive independent Gaussian noise. Applying this to the WLS method with $\mathrm{var}(\boldsymbol{y}) = \boldsymbol{W}^{-1}$ yields the covariance matrix

\begin{equation}\label{eq:ParaVar}
	\begin{aligned}
&	\mathrm{var}(\hat{\boldsymbol{\theta}}) &= {}& \mathrm{var}((\boldsymbol{C}^\mathrm{T} \boldsymbol{W} \boldsymbol{C})^{-1} \boldsymbol{C}^\mathrm{T} \boldsymbol{W} \boldsymbol{y}) \\
&								&= {}& (\boldsymbol{C}^\mathrm{T} \boldsymbol{W} \boldsymbol{C})^{-1} \boldsymbol{C}^\mathrm{T} \boldsymbol{W} \mathrm{var}(\boldsymbol{y}) \boldsymbol{W}^\mathrm{T} \boldsymbol{C} (\boldsymbol{C}^\mathrm{T} \boldsymbol{W} \boldsymbol{C})^{-\mathrm{T}} \\
&								&= {}& (\boldsymbol{C}^\mathrm{T} \boldsymbol{W} \boldsymbol{C})^{-1},
	\end{aligned}
\end{equation}

and the relative standard deviation of the identified parameters

\begin{equation}\label{eq:ParaVar_rel}
	\sigma_{i}^* = \frac{\sigma_{i}}{\left| \hat{\theta}_i \right|} \text{ with } \sigma_{i}^2 = \mathrm{var}(\hat{\boldsymbol{\theta}})_{ii}.
\end{equation}

%The $i$-th diagonal element $\sigma_{i}^2$ of $\mathrm{var}(\hat{\boldsymbol{\theta}})$ corresponds to the standard deviation $\sigma_i$ of parameter $i$. 
The estimated parameters and standard deviations for trajectories \textit{A} and \textit{B} are given in Tab.\,\ref{tab:ParamTheta}. For convenience the derived models will now be called model A and B respectively. It can be seen that parameters with a relatively high standard deviation have small identified values compared to other parameters with a lower standard deviation. These parameters could either not be sufficiently excited or their contribution to the model is negligible \cite{Khalil.2006}.

\begin{table}
	\caption{Estimated parameters for model A and B.}\label{tab:ParamTheta}
	\centering
	\begin{tabular}[h]{|r||c|c||c|c|}\hline
		\input{Chapters/Experimental_Results/Optimal_Excitation/Table_Parameters}
		\hline
	\end{tabular}
\end{table}

The absolute and relative model errors $e_{j}$ and $e^*_{j}$ for models A and B according to \eqref{eq:absError} and \eqref{eq:relError} are given in Tab.\,\ref{tab:errorModelA} and Tab.\,\ref{tab:errorModelB} respectively. Greater deviations between the model predictions and the measured torques result from the noise on the measured torques and the dynamic behavior of the controlled system like the characteristics of the controller and the compensation of overshoots. It can be seen that both models produce approximately the same model prediction error for all trajectories. This leads to the conclusion that the model parameters were sufficiently excited during the experiments and both models can be used as reference for the process-based parameter estimation.

\begin{table}
	\caption{Prediction error for model A.}\label{tab:errorModelA}
	\centering
	\begin{tabular}[h]{|r||c|c||c|c|}\hline
		\input{Chapters/Experimental_Results/Optimal_Excitation/Table_errorModelA}
		\hline
	\end{tabular}
\end{table}

\begin{table}
	\caption{Prediction error for model B.}\label{tab:errorModelB}
	\centering
	\begin{tabular}[h]{|r||c|c||c|c|}\hline
		\input{Chapters/Experimental_Results/Optimal_Excitation/Table_errorModelB}
		\hline
	\end{tabular}
\end{table}